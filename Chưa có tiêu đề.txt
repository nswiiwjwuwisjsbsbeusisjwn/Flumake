local player = game.Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")

if CoreGui:FindFirstChild('Crystal hub') then
    CoreGui:FindFirstChild('Crystal hub'):Destroy()
end

local Crystal = {
    TweenService = game:GetService("TweenService"),
    Player = game.Players.LocalPlayer,
    Workspace = workspace,
    CoreGui = game:GetService("CoreGui"),
    UserInputService = game:GetService("UserInputService"),
    Mouse = game.Players.LocalPlayer:GetMouse(),
    ViewportSize = workspace.CurrentCamera.ViewportSize,
    Stepped = game:GetService("RunService").Stepped,
    OldMouseIcon = game.Players.LocalPlayer:GetMouse().Icon
}

-- Utility Functions
Crystal.TweenObject = function(config)
    config.Object = config.Object or config[1]
    config.Time = config.Time or config[2]
    config.OldValue = config.OldValue or config[3]
    config.NewValue = config.NewValue or config[4]
    local Info = TweenInfo.new(config.Time, Enum.EasingStyle.Quint)
    local tween = Crystal.TweenService:Create(config.Object, Info, {[config.OldValue] = config.NewValue})
    tween:Play()
    return tween
end

Crystal.Click = function(Object, callback)
    Object.Activated:Connect(function()
        callback()
    end)
end

Crystal.Find = function(Object, Name)
    for _, v in next, Object:GetChildren() do
        if v.Name == Name then
            return v
        end
    end
end

Crystal.Mouseto = function(Object, CallbackEnter, CallbackLeave)
    Object.MouseEnter:Connect(function()
        CallbackEnter()
    end)
    Object.MouseLeave:Connect(function()
        CallbackLeave()
    end)
end

Crystal.MakeDraggable = function(object, top)
    local Dragging = nil
    local DragInput = nil
    local DragStart = nil
    local StartPosition = nil
    local function UpdatePos(input)
        local Delta = input.Position - DragStart
        local newPos = UDim2.new(
            StartPosition.X.Scale,
            StartPosition.X.Offset + Delta.X,
            StartPosition.Y.Scale,
            StartPosition.Y.Offset + Delta.Y
        )
        object.Position = newPos
    end
    top.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    top.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)
    Crystal.UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            UpdatePos(input)
        end
    end)
end

Crystal.CustomSize = function(object)
    local Dragging = false
    local DragInput = nil
    local DragStart = nil
    local StartSize = nil
    local maxSizeX = object.Size.X.Offset
    local maxSizeY = object.Size.Y.Offset
    object.Size = UDim2.new(0, maxSizeX, 0, maxSizeY)
    local changesizeobject = Instance.new("Frame")
    changesizeobject.AnchorPoint = Vector2.new(1, 1)
    changesizeobject.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    changesizeobject.BackgroundTransparency = 0.999
    changesizeobject.BorderColor3 = Color3.fromRGB(0, 0, 0)
    changesizeobject.BorderSizePixel = 0
    changesizeobject.Position = UDim2.new(1, 20, 1, 20)
    changesizeobject.Size = UDim2.new(0, 40, 0, 40)
    changesizeobject.Name = "changesizeobject"
    changesizeobject.Parent = object
    Crystal.Mouseto(changesizeobject, function()
        Crystal.Mouse.Icon = "rbxassetid://97880490001888"
    end, function()
        Crystal.Mouse.Icon = Crystal.OldMouseIcon
    end)
    local function UpdateSize(input)
        local Delta = input.Position - DragStart
        local newWidth = StartSize.X.Offset + Delta.X
        local newHeight = StartSize.Y.Offset + Delta.Y
        newWidth = math.max(newWidth, maxSizeX)
        newHeight = math.max(newHeight, maxSizeY)
        object.Size = UDim2.new(0, newWidth, 0, newHeight)
    end
    changesizeobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartSize = object.Size
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    changesizeobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)
    Crystal.UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            UpdateSize(input)
        end
    end)
end

Crystal.GetMidPos = function(mainFrame)
    return UDim2.new(0, (Crystal.ViewportSize.X/2 - mainFrame.Size.X.Offset/2), 0, (Crystal.ViewportSize.Y/2 - mainFrame.Size.Y.Offset/2))
end

Crystal.Colors = { 
    Primary = Color3.fromRGB(100, 200, 255), 
    Secondary = Color3.fromRGB(180, 100, 255), 
    Background = Color3.fromRGB(10, 10, 20), 
    BackgroundSecondary = Color3.fromRGB(15, 20, 35), 
    BackgroundTertiary = Color3.fromRGB(20, 25, 40), 
    Text = Color3.fromRGB(255, 255, 255), 
    TextSecondary = Color3.fromRGB(180, 180, 180), 
    Border = Color3.fromRGB(80, 60, 120), 
    Accent = Color3.fromRGB(200, 170, 255) 
}

Crystal.Window = function(self, WindowConfig)
    WindowConfig = WindowConfig or {}
    WindowConfig.Title = WindowConfig.Title or "Crystal Hub"
    WindowConfig.Description = WindowConfig.Description or ""
    WindowConfig.Size = WindowConfig.Size or UDim2.new(0, 600, 0, 400)
    WindowConfig.KeyCode = WindowConfig.KeyCode or Enum.KeyCode.RightControl

    local CrystalHub = {}
    CrystalHub.Window = Instance.new("ScreenGui")
    CrystalHub.MainFrame = Instance.new("Frame")
    CrystalHub.DropShadowHolder = Instance.new("Frame")
    CrystalHub.DropShadow = Instance.new("ImageLabel")
    CrystalHub.TopBar = Instance.new("Frame")
    CrystalHub.TopTitle = Instance.new("TextLabel")
    CrystalHub.TopDescription = Instance.new("TextLabel")
    CrystalHub.CloseButton = Instance.new("TextButton")
    CrystalHub.CloseImage = Instance.new("ImageLabel")
    CrystalHub.CloseBorderLeft = Instance.new("Frame")
    CrystalHub.CloseBorderBottom = Instance.new("Frame")
    CrystalHub.MaxButton = Instance.new("TextButton")
    CrystalHub.MaxImage = Instance.new("ImageLabel")
    CrystalHub.HideButton = Instance.new("TextButton")
    CrystalHub.HideImage = Instance.new("ImageLabel")
    CrystalHub.DecideFrame = Instance.new("Frame")
    CrystalHub.DecideCorner = Instance.new("UICorner")
    
    -- Player Info
    CrystalHub.PlayerInfo = Instance.new("Frame")
    CrystalHub.InfoCorner = Instance.new("UICorner")
    CrystalHub.PlayerName = Instance.new("TextLabel")
    CrystalHub.PlayerDescription = Instance.new("TextLabel")
    CrystalHub.AvatarFrame = Instance.new("Frame")
    CrystalHub.AvatarImage = Instance.new("ImageLabel")
    CrystalHub.AvatarCorner = Instance.new("UICorner")
    CrystalHub.AvatarFrameCorner = Instance.new("UICorner")
    CrystalHub.AvatarStroke = Instance.new("UIStroke")
    CrystalHub.StatusIndicator = Instance.new("Frame")
    CrystalHub.StatusCorner = Instance.new("UICorner")
    CrystalHub.StatusStroke = Instance.new("UIStroke")
    
    -- Horizontal Tab Container
    CrystalHub.TabContainer = Instance.new("Frame")
    CrystalHub.TabScrollFrame = Instance.new("ScrollingFrame")
    CrystalHub.TabListLayout = Instance.new("UIListLayout")
    
    -- Paragraph Container (Below Tabs)
    CrystalHub.ParagraphContainer = Instance.new("Frame")
    CrystalHub.ParagraphScroll = Instance.new("ScrollingFrame")
    CrystalHub.ParagraphLayout = Instance.new("UIListLayout")
    
    -- Divider between tabs and paragraphs
    CrystalHub.Divider = Instance.new("Frame")
    
    CrystalHub.MainCorner = Instance.new("UICorner")
    CrystalHub.MainStroke = Instance.new("UIStroke")
    CrystalHub.Layers = Instance.new("Frame")
    CrystalHub.LayersFolder = Instance.new("Folder")
    CrystalHub.CloseCorner = Instance.new("UICorner")

    CrystalHub.Window.Name = "Crystal hub"
    CrystalHub.Window.Parent = Crystal.CoreGui
    CrystalHub.Window.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    CrystalHub.MainFrame.Name = "Window11"
    CrystalHub.MainFrame.Parent = CrystalHub.Window
    CrystalHub.MainFrame.BackgroundColor3 = Color3.fromRGB(60, 40, 100)
    CrystalHub.MainFrame.BackgroundTransparency = 0.020
    CrystalHub.MainFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MainFrame.BorderSizePixel = 0
    CrystalHub.MainFrame.Size = WindowConfig.Size
    CrystalHub.MainFrame.Position = Crystal.GetMidPos(CrystalHub.MainFrame)

    CrystalHub.MainCorner.CornerRadius = UDim.new(0, 12)
    CrystalHub.MainCorner.Parent = CrystalHub.MainFrame

    CrystalHub.MainStroke.Parent = CrystalHub.MainFrame
    CrystalHub.MainStroke.Color = Color3.fromRGB(80, 60, 120)
    CrystalHub.MainStroke.Thickness = 1.800

    CrystalHub.DropShadowHolder.Name = "DropShadowHolder"
    CrystalHub.DropShadowHolder.Parent = CrystalHub.MainFrame
    CrystalHub.DropShadowHolder.BackgroundTransparency = 1.000
    CrystalHub.DropShadowHolder.BorderSizePixel = 0
    CrystalHub.DropShadowHolder.Size = UDim2.new(1, 0, 1, 0)
    CrystalHub.DropShadowHolder.ZIndex = 0

    CrystalHub.DropShadow.Name = "DropShadow"
    CrystalHub.DropShadow.Parent = CrystalHub.DropShadowHolder
    CrystalHub.DropShadow.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.DropShadow.BackgroundTransparency = 1.000
    CrystalHub.DropShadow.BorderSizePixel = 0
    CrystalHub.DropShadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.DropShadow.Size = UDim2.new(1, 47, 1, 47)
    CrystalHub.DropShadow.ZIndex = 0
    CrystalHub.DropShadow.Image = "rbxassetid://6015897843"
    CrystalHub.DropShadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.DropShadow.ImageTransparency = 0.300
    CrystalHub.DropShadow.ScaleType = Enum.ScaleType.Slice
    CrystalHub.DropShadow.SliceCenter = Rect.new(49, 49, 450, 450)

    CrystalHub.TopBar.Name = "Top"
    CrystalHub.TopBar.Parent = CrystalHub.MainFrame
    CrystalHub.TopBar.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopBar.BackgroundTransparency = 0.999
    CrystalHub.TopBar.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopBar.BorderSizePixel = 0
    CrystalHub.TopBar.Size = UDim2.new(1, 0, 0, 40)
    CrystalHub.TopBar.ZIndex = 2

    CrystalHub.TopTitle.Name = "TopTitle"
    CrystalHub.TopTitle.Parent = CrystalHub.TopBar
    CrystalHub.TopTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopTitle.BackgroundTransparency = 0.999
    CrystalHub.TopTitle.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopTitle.BorderSizePixel = 0
    CrystalHub.TopTitle.Position = UDim2.new(0, 15, 0, 12)
    CrystalHub.TopTitle.Size = UDim2.new(0, 100, 0, 16)
    CrystalHub.TopTitle.Font = Enum.Font.Arcade
    CrystalHub.TopTitle.Text = WindowConfig.Title
    CrystalHub.TopTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopTitle.TextSize = 14.000
    CrystalHub.TopTitle.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.TopDescription.Name = "TopDescription"
    CrystalHub.TopDescription.Parent = CrystalHub.TopBar
    CrystalHub.TopDescription.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopDescription.BackgroundTransparency = 0.999
    CrystalHub.TopDescription.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopDescription.BorderSizePixel = 0
    CrystalHub.TopDescription.Position = UDim2.new(0, 0, 0, 12)
    CrystalHub.TopDescription.Size = UDim2.new(0, 80, 0, 16)
    CrystalHub.TopDescription.Font = Enum.Font.GothamBold
    CrystalHub.TopDescription.Text = WindowConfig.Description
    CrystalHub.TopDescription.TextColor3 = Color3.fromRGB(200, 170, 255)
    CrystalHub.TopDescription.TextSize = 12.000
    CrystalHub.TopDescription.TextTransparency = 0.300
    CrystalHub.TopDescription.TextXAlignment = Enum.TextXAlignment.Left
    
    CrystalHub.CloseButton.Name = "CloseButton"
    CrystalHub.CloseButton.Parent = CrystalHub.TopBar
    CrystalHub.CloseButton.AnchorPoint = Vector2.new(1, 0)
    CrystalHub.CloseButton.BackgroundTransparency = 1.000
    CrystalHub.CloseButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.CloseButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseButton.BorderSizePixel = 0
    CrystalHub.CloseButton.Position = UDim2.new(1, 0, 0, 0)
    CrystalHub.CloseButton.Size = UDim2.new(0, 40, 0, 40)
    CrystalHub.CloseButton.Font = Enum.Font.GothamBold
    CrystalHub.CloseButton.AutoButtonColor = false
    CrystalHub.CloseButton.Text = ""
    CrystalHub.CloseButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseButton.TextSize = 14.000

    Crystal.Mouseto(CrystalHub.CloseButton, function()
        Crystal.TweenObject({CrystalHub.CloseButton, 0.2, "BackgroundTransparency", 0.970})
        Crystal.TweenObject({CrystalHub.CloseBorderLeft, 0.2, "BackgroundTransparency", 0.000})
        Crystal.TweenObject({CrystalHub.CloseBorderBottom, 0.2, "BackgroundTransparency", 0.000})
    end, function()
        Crystal.TweenObject({CrystalHub.CloseButton, 0.2, "BackgroundTransparency", 1.000})
        Crystal.TweenObject({CrystalHub.CloseBorderLeft, 0.2, "BackgroundTransparency", 1.000})
        Crystal.TweenObject({CrystalHub.CloseBorderBottom, 0.2, "BackgroundTransparency", 1.000})
    end)

    Crystal.Click(CrystalHub.CloseButton, function()
        CrystalHub.MainFrame.Visible = false
    end)

    CrystalHub.CloseCorner.CornerRadius = UDim.new(0, 12)
    CrystalHub.CloseCorner.Parent = CrystalHub.CloseButton

    CrystalHub.CloseImage.Name = "CloseImage"
    CrystalHub.CloseImage.Parent = CrystalHub.CloseButton
    CrystalHub.CloseImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.CloseImage.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.CloseImage.BackgroundTransparency = 0.999
    CrystalHub.CloseImage.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseImage.BorderSizePixel = 0
    CrystalHub.CloseImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.CloseImage.Size = UDim2.new(1, -22, 1, -22)
    CrystalHub.CloseImage.Image = "rbxassetid://18556800637"
    CrystalHub.CloseImage.ImageColor3 = Color3.fromRGB(230, 230, 230)

    CrystalHub.CloseBorderLeft.Name = "FrameBiNgu"
    CrystalHub.CloseBorderLeft.Parent = CrystalHub.CloseButton
    CrystalHub.CloseBorderLeft.BackgroundColor3 = Color3.fromRGB(100, 220, 255)
    CrystalHub.CloseBorderLeft.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseBorderLeft.BorderSizePixel = 0
    CrystalHub.CloseBorderLeft.Size = UDim2.new(0, 7, 1, 0)
    CrystalHub.CloseBorderLeft.BackgroundTransparency = 1.000

    CrystalHub.CloseBorderBottom.Name = "FrameOc"
    CrystalHub.CloseBorderBottom.Parent = CrystalHub.CloseButton
    CrystalHub.CloseBorderBottom.BackgroundColor3 = Color3.fromRGB(100, 220, 255)
    CrystalHub.CloseBorderBottom.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseBorderBottom.BorderSizePixel = 0
    CrystalHub.CloseBorderBottom.BackgroundTransparency = 1.000
    CrystalHub.CloseBorderBottom.Position = UDim2.new(0, 0, 1, -5)
    CrystalHub.CloseBorderBottom.Size = UDim2.new(1, 0, 0, 5)

    CrystalHub.MaxButton.Name = "MaxButton"
    CrystalHub.MaxButton.Parent = CrystalHub.TopBar
    CrystalHub.MaxButton.AutoButtonColor = false
    CrystalHub.MaxButton.AnchorPoint = Vector2.new(1, 0)
    CrystalHub.MaxButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.MaxButton.BackgroundTransparency = 0.999
    CrystalHub.MaxButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MaxButton.BorderSizePixel = 0
    CrystalHub.MaxButton.Position = UDim2.new(1, -39, 0, 0)
    CrystalHub.MaxButton.Size = UDim2.new(0, 40, 0, 40)
    CrystalHub.MaxButton.Font = Enum.Font.GothamBold
    CrystalHub.MaxButton.Text = ""
    CrystalHub.MaxButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MaxButton.TextSize = 14.000

    local OldPos, OldSize
    Crystal.Click(CrystalHub.MaxButton, function()
        if CrystalHub.MainFrame.Size.Y.Scale < 1 then
            OldPos = CrystalHub.MainFrame.Position
            OldSize = CrystalHub.MainFrame.Size
            Crystal.TweenObject({CrystalHub.MainFrame, 0.5, "Size", UDim2.new(1, 0, 1, 0)})
            Crystal.TweenObject({CrystalHub.MainFrame, 0.5, "Position", UDim2.new(0, 0, 0, 0)})
        else
            Crystal.TweenObject({CrystalHub.MainFrame, 0.5, "Size", OldSize})
            Crystal.TweenObject({CrystalHub.MainFrame, 0.5, "Position", OldPos})
        end
    end)

    Crystal.Mouseto(CrystalHub.MaxButton, function()
        CrystalHub.MaxButton.BackgroundTransparency = 0.970
        Crystal.TweenObject({CrystalHub.MaxImage, 0.2, "ImageColor3", Color3.fromRGB(255, 255, 255)})
    end, function()
        CrystalHub.MaxButton.BackgroundTransparency = 0.999
        Crystal.TweenObject({CrystalHub.MaxImage, 0.2, "ImageColor3", Color3.fromRGB(230, 230, 230)})
    end)

    CrystalHub.MaxImage.Name = "MaxImage"
    CrystalHub.MaxImage.Parent = CrystalHub.MaxButton
    CrystalHub.MaxImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.MaxImage.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.MaxImage.BackgroundTransparency = 0.999
    CrystalHub.MaxImage.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MaxImage.BorderSizePixel = 0
    CrystalHub.MaxImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.MaxImage.Size = UDim2.new(1, -24, 1, -24)
    CrystalHub.MaxImage.Image = "rbxassetid://9886659406"
    CrystalHub.MaxImage.ImageColor3 = Color3.fromRGB(230, 230, 230)

    CrystalHub.HideButton.Name = "HideButton"
    CrystalHub.HideButton.Parent = CrystalHub.TopBar
    CrystalHub.HideButton.AutoButtonColor = false
    CrystalHub.HideButton.AnchorPoint = Vector2.new(1, 0)
    CrystalHub.HideButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    CrystalHub.HideButton.BackgroundTransparency = 0.999
    CrystalHub.HideButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.HideButton.BorderSizePixel = 0
    CrystalHub.HideButton.Position = UDim2.new(1, -77, 0, 0)
    CrystalHub.HideButton.Size = UDim2.new(0, 40, 0, 40)
    CrystalHub.HideButton.Font = Enum.Font.GothamBold
    CrystalHub.HideButton.Text = ""
    CrystalHub.HideButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.HideButton.TextSize = 14.000

    Crystal.Mouseto(CrystalHub.HideButton, function()
        CrystalHub.HideButton.BackgroundTransparency = 0.950
        Crystal.TweenObject({CrystalHub.HideImage, 0.2, "ImageColor3", Color3.fromRGB(255, 255, 255)})
    end, function()
        CrystalHub.HideButton.BackgroundTransparency = 0.999
        Crystal.TweenObject({CrystalHub.HideImage, 0.2, "ImageColor3", Color3.fromRGB(230, 230, 230)})
    end)

    Crystal.Click(CrystalHub.HideButton, function()
        CrystalHub.MainFrame.Visible = false
    end)

    CrystalHub.HideImage.Name = "HideImage"
    CrystalHub.HideImage.Parent = CrystalHub.HideButton
    CrystalHub.HideImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.HideImage.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.HideImage.BackgroundTransparency = 0.999
    CrystalHub.HideImage.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.HideImage.BorderSizePixel = 0
    CrystalHub.HideImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.HideImage.Size = UDim2.new(1, -24, 1, -24)
    CrystalHub.HideImage.Image = "rbxassetid://18556824827"
    CrystalHub.HideImage.ImageColor3 = Color3.fromRGB(230, 230, 230)

    CrystalHub.DecideFrame.Name = "DecideFrame"
    CrystalHub.DecideFrame.Parent = CrystalHub.TopBar
    CrystalHub.DecideFrame.AnchorPoint = Vector2.new(0.5, 1)
    CrystalHub.DecideFrame.BackgroundColor3 = Color3.fromRGB(200, 170, 255)
    CrystalHub.DecideFrame.BackgroundTransparency = 0.800
    CrystalHub.DecideFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.DecideFrame.BorderSizePixel = 0
    CrystalHub.DecideFrame.Position = UDim2.new(0.5, 0, 1, 2)
    CrystalHub.DecideFrame.Size = UDim2.new(1, -14, 0, 2)
    
    CrystalHub.DecideCorner.CornerRadius = UDim.new(0, 100)
    CrystalHub.DecideCorner.Parent = CrystalHub.DecideFrame

    -- Player Info Section (Top Left)
    CrystalHub.PlayerInfo.Name = "Info"
    CrystalHub.PlayerInfo.Parent = CrystalHub.MainFrame
    CrystalHub.PlayerInfo.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    CrystalHub.PlayerInfo.BackgroundTransparency = 1.000
    CrystalHub.PlayerInfo.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerInfo.BorderSizePixel = 0
    CrystalHub.PlayerInfo.Position = UDim2.new(0, 10, 0, 48)
    CrystalHub.PlayerInfo.Size = UDim2.new(0, 140, 0, 48)

    Crystal.Mouseto(CrystalHub.PlayerInfo, function()
        CrystalHub.PlayerInfo.BackgroundTransparency = 0.950
        Crystal.TweenObject({CrystalHub.AvatarStroke, 0.3, "Transparency", 0.400})
    end, function()
        CrystalHub.PlayerInfo.BackgroundTransparency = 1.000
        Crystal.TweenObject({CrystalHub.AvatarStroke, 0.3, "Transparency", 0.700})
    end)

    CrystalHub.InfoCorner.CornerRadius = UDim.new(0, 6)
    CrystalHub.InfoCorner.Parent = CrystalHub.PlayerInfo

    CrystalHub.PlayerName.Name = "NamePlayer"
    CrystalHub.PlayerName.Parent = CrystalHub.PlayerInfo
    CrystalHub.PlayerName.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerName.BackgroundTransparency = 0.999
    CrystalHub.PlayerName.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerName.BorderSizePixel = 0
    CrystalHub.PlayerName.Position = UDim2.new(0, 46, 0, 10)
    CrystalHub.PlayerName.Size = UDim2.new(1, -50, 0, 12)
    CrystalHub.PlayerName.Font = Enum.Font.GothamBold
    CrystalHub.PlayerName.Text = tostring(Crystal.Player.DisplayName)
    CrystalHub.PlayerName.TextColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerName.TextSize = 12.000
    CrystalHub.PlayerName.TextWrapped = true
    CrystalHub.PlayerName.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.PlayerDescription.Name = "DescriptionPlayer"
    CrystalHub.PlayerDescription.Parent = CrystalHub.PlayerInfo
    CrystalHub.PlayerDescription.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerDescription.BackgroundTransparency = 0.999
    CrystalHub.PlayerDescription.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerDescription.BorderSizePixel = 0
    CrystalHub.PlayerDescription.Position = UDim2.new(0, 46, 0, 24)
    CrystalHub.PlayerDescription.Size = UDim2.new(1, -50, 0, 9)
    CrystalHub.PlayerDescription.Font = Enum.Font.GothamBold
    CrystalHub.PlayerDescription.Text = tostring(Crystal.Player.UserId)
    CrystalHub.PlayerDescription.TextColor3 = Color3.fromRGB(120, 120, 120)
    CrystalHub.PlayerDescription.TextSize = 8.000
    CrystalHub.PlayerDescription.TextTransparency = 0.400
    CrystalHub.PlayerDescription.TextWrapped = true
    CrystalHub.PlayerDescription.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.AvatarFrame.Name = "LogoFrame"
    CrystalHub.AvatarFrame.Parent = CrystalHub.PlayerInfo
    CrystalHub.AvatarFrame.AnchorPoint = Vector2.new(0, 0.5)
    CrystalHub.AvatarFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    CrystalHub.AvatarFrame.BackgroundTransparency = 0.850
    CrystalHub.AvatarFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.AvatarFrame.BorderSizePixel = 0
    CrystalHub.AvatarFrame.Position = UDim2.new(0, 4, 0.5, 0)
    CrystalHub.AvatarFrame.Size = UDim2.new(0, 38, 0, 38)

    CrystalHub.AvatarImage.Name = "LogoPlayer"
    CrystalHub.AvatarImage.Parent = CrystalHub.AvatarFrame
    CrystalHub.AvatarImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.AvatarImage.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.AvatarImage.BackgroundTransparency = 0.999
    CrystalHub.AvatarImage.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.AvatarImage.BorderSizePixel = 0
    CrystalHub.AvatarImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.AvatarImage.Size = UDim2.new(1, -2, 1, -2)
    CrystalHub.AvatarImage.Image = "https://www.roblox.com/headshot-thumbnail/image?userId="..Crystal.Player.UserId.."&width=420&height=420&format=png"

    CrystalHub.AvatarCorner.CornerRadius = UDim.new(0, 1000)
    CrystalHub.AvatarCorner.Parent = CrystalHub.AvatarImage

    CrystalHub.AvatarFrameCorner.CornerRadius = UDim.new(0, 1000)
    CrystalHub.AvatarFrameCorner.Parent = CrystalHub.AvatarFrame

    CrystalHub.AvatarStroke.Parent = CrystalHub.AvatarFrame
    CrystalHub.AvatarStroke.Color = Color3.fromRGB(200, 170, 255)
    CrystalHub.AvatarStroke.Transparency = 0.700
    CrystalHub.AvatarStroke.Thickness = 2.000

    CrystalHub.StatusIndicator.Name = "StatusIndicator"
    CrystalHub.StatusIndicator.Parent = CrystalHub.AvatarFrame
    CrystalHub.StatusIndicator.AnchorPoint = Vector2.new(1, 1)
    CrystalHub.StatusIndicator.BackgroundColor3 = Color3.fromRGB(67, 181, 129)
    CrystalHub.StatusIndicator.BorderSizePixel = 0
    CrystalHub.StatusIndicator.Position = UDim2.new(1, -1, 1, -1)
    CrystalHub.StatusIndicator.Size = UDim2.new(0, 11, 0, 11)
    CrystalHub.StatusIndicator.ZIndex = 5

    CrystalHub.StatusCorner.CornerRadius = UDim.new(1, 0)
    CrystalHub.StatusCorner.Parent = CrystalHub.StatusIndicator

    CrystalHub.StatusStroke.Parent = CrystalHub.StatusIndicator
    CrystalHub.StatusStroke.Color = Color3.fromRGB(20, 20, 20)
    CrystalHub.StatusStroke.Thickness = 2.000

    -- HORIZONTAL TAB CONTAINER
    CrystalHub.TabContainer.Name = "TabContainer"
    CrystalHub.TabContainer.Parent = CrystalHub.MainFrame
    CrystalHub.TabContainer.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TabContainer.BackgroundTransparency = 0.999
    CrystalHub.TabContainer.BorderSizePixel = 0
    CrystalHub.TabContainer.Position = UDim2.new(0, 10, 0, 104)
    CrystalHub.TabContainer.Size = UDim2.new(0, 140, 0, 40)

    CrystalHub.TabScrollFrame.Name = "TabScrollFrame"
    CrystalHub.TabScrollFrame.Parent = CrystalHub.TabContainer
    CrystalHub.TabScrollFrame.Active = true
    CrystalHub.TabScrollFrame.BackgroundTransparency = 0.999
    CrystalHub.TabScrollFrame.BorderSizePixel = 0
    CrystalHub.TabScrollFrame.Size = UDim2.new(1, 0, 1, 0)
    CrystalHub.TabScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(200, 170, 255)
    CrystalHub.TabScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    CrystalHub.TabScrollFrame.ScrollBarImageTransparency = 0.700
    CrystalHub.TabScrollFrame.ScrollBarThickness = 3
    CrystalHub.TabScrollFrame.ScrollingDirection = Enum.ScrollingDirection.X

    CrystalHub.TabListLayout.Parent = CrystalHub.TabScrollFrame
    CrystalHub.TabListLayout.FillDirection = Enum.FillDirection.Horizontal
    CrystalHub.TabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    CrystalHub.TabListLayout.Padding = UDim.new(0, 6)

    Crystal.Stepped:Connect(function()
        CrystalHub.TabScrollFrame.CanvasSize = UDim2.new(0, CrystalHub.TabListLayout.AbsoluteContentSize.X + 10, 0, 0)
    end)

    -- DIVIDER between Tabs and Paragraphs
    CrystalHub.Divider.Name = "Divider"
    CrystalHub.Divider.Parent = CrystalHub.MainFrame
    CrystalHub.Divider.BackgroundColor3 = Color3.fromRGB(200, 170, 255)
    CrystalHub.Divider.BackgroundTransparency = 0.800
    CrystalHub.Divider.BorderSizePixel = 0
    CrystalHub.Divider.Position = UDim2.new(0, 10, 0, 150)
    CrystalHub.Divider.Size = UDim2.new(0, 140, 0, 1)

    -- PARAGRAPH CONTAINER (Below Tabs)
    CrystalHub.ParagraphContainer.Name = "ParagraphContainer"
    CrystalHub.ParagraphContainer.Parent = CrystalHub.MainFrame
    CrystalHub.ParagraphContainer.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.ParagraphContainer.BackgroundTransparency = 0.999
    CrystalHub.ParagraphContainer.BorderSizePixel = 0
    CrystalHub.ParagraphContainer.Position = UDim2.new(0, 10, 0, 158)
    CrystalHub.ParagraphContainer.Size = UDim2.new(0, 140, 1, -168)

    CrystalHub.ParagraphScroll.Name = "ParagraphScroll"
    CrystalHub.ParagraphScroll.Parent = CrystalHub.ParagraphContainer
    CrystalHub.ParagraphScroll.Active = true
    CrystalHub.ParagraphScroll.BackgroundTransparency = 0.999
    CrystalHub.ParagraphScroll.BorderSizePixel = 0
    CrystalHub.ParagraphScroll.Size = UDim2.new(1, 0, 1, 0)
    CrystalHub.ParagraphScroll.ScrollBarImageColor3 = Color3.fromRGB(200, 170, 255)
    CrystalHub.ParagraphScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    CrystalHub.ParagraphScroll.ScrollBarImageTransparency = 0.700
    CrystalHub.ParagraphScroll.ScrollBarThickness = 3

    CrystalHub.ParagraphLayout.Parent = CrystalHub.ParagraphScroll
    CrystalHub.ParagraphLayout.SortOrder = Enum.SortOrder.LayoutOrder
    CrystalHub.ParagraphLayout.Padding = UDim.new(0, 8)

    Crystal.Stepped:Connect(function()
        CrystalHub.ParagraphScroll.CanvasSize = UDim2.new(0, 0, 0, CrystalHub.ParagraphLayout.AbsoluteContentSize.Y + 10)
    end)

    -- Content/Layers Area
    CrystalHub.Layers.Name = "Layers"
    CrystalHub.Layers.Parent = CrystalHub.MainFrame
    CrystalHub.Layers.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.Layers.BackgroundTransparency = 0.999
    CrystalHub.Layers.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.Layers.BorderSizePixel = 0
    CrystalHub.Layers.Position = UDim2.new(0, 158, 0, 48)
    CrystalHub.Layers.Size = UDim2.new(1, -168, 1, -58)
    CrystalHub.Layers.ZIndex = 3
    CrystalHub.Layers.ClipsDescendants = true

    CrystalHub.LayersFolder.Name = "LayersFolder"
    CrystalHub.LayersFolder.Parent = CrystalHub.Layers

    local LayersPageLayout = Instance.new("UIPageLayout")
    LayersPageLayout.Name = "LayersPageLayout"
    LayersPageLayout.Parent = CrystalHub.LayersFolder
    LayersPageLayout.SortOrder = Enum.SortOrder.LayoutOrder
    LayersPageLayout.EasingDirection = Enum.EasingDirection.InOut
    LayersPageLayout.EasingStyle = Enum.EasingStyle.Quad
    LayersPageLayout.GamepadInputEnabled = false
    LayersPageLayout.ScrollWheelInputEnabled = false
    LayersPageLayout.TouchInputEnabled = false
    LayersPageLayout.TweenTime = 0.350

    CrystalHub.TopDescription.Position = UDim2.new(0, CrystalHub.TopTitle.TextBounds.X + 19, 0, 12)

    Crystal.MakeDraggable(CrystalHub.MainFrame, CrystalHub.TopBar)
    Crystal.CustomSize(CrystalHub.MainFrame)

    Crystal.UserInputService.InputBegan:Connect(function(input)
        if input.KeyCode == WindowConfig.KeyCode then
            CrystalHub.MainFrame.Visible = not CrystalHub.MainFrame.Visible
        end
    end)

    local WindowSystem = {}
    local TabCount = 0
    local CurrentTab = nil

    -- ADD PARAGRAPH FUNCTION (Outside of Tabs)
    function WindowSystem:CParagraph(ParagraphConfig)
        ParagraphConfig = ParagraphConfig or {}
        ParagraphConfig.Title = ParagraphConfig.Title or "Paragraph"
        ParagraphConfig.Content = ParagraphConfig.Content or ""
        ParagraphConfig.IconLabel = ParagraphConfig.IconLabel or ""
        ParagraphConfig.SizeIcon = ParagraphConfig.SizeIcon or 18

        local Paragraph = Instance.new("Frame")
        local ParagraphCorner = Instance.new("UICorner")
        local ParagraphIcon = Instance.new("ImageLabel")
        local ParagraphTitle = Instance.new("TextLabel")
        local ParagraphContent = Instance.new("TextLabel")

        Paragraph.Name = ParagraphConfig.Title
        Paragraph.Parent = CrystalHub.ParagraphScroll
        Paragraph.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        Paragraph.BackgroundTransparency = 0.920
        Paragraph.BorderSizePixel = 0
        Paragraph.Size = UDim2.new(1, 0, 0, 70)
        Paragraph.AutomaticSize = Enum.AutomaticSize.Y

        ParagraphCorner.CornerRadius = UDim.new(0, 6)
        ParagraphCorner.Parent = Paragraph

        if ParagraphConfig.IconLabel ~= "" then
            ParagraphIcon.Name = "ParagraphIcon"
            ParagraphIcon.Parent = Paragraph
            ParagraphIcon.BackgroundTransparency = 1
            ParagraphIcon.Position = UDim2.new(0, 8, 0, 8)
            ParagraphIcon.Size = UDim2.new(0, ParagraphConfig.SizeIcon, 0, ParagraphConfig.SizeIcon)
            ParagraphIcon.Image = ParagraphConfig.IconLabel
            ParagraphIcon.ImageColor3 = Color3.fromRGB(200, 170, 255)
            ParagraphIcon.ImageTransparency = 0.3
        end

        ParagraphTitle.Name = "ParagraphTitle"
        ParagraphTitle.Parent = Paragraph
        ParagraphTitle.BackgroundTransparency = 1
        ParagraphTitle.Position = ParagraphConfig.IconLabel ~= "" and UDim2.new(0, ParagraphConfig.SizeIcon + 14, 0, 6) or UDim2.new(0, 8, 0, 6)
        ParagraphTitle.Size = UDim2.new(1, -(ParagraphConfig.IconLabel ~= "" and (ParagraphConfig.SizeIcon + 20) or 14), 0, 14)
        ParagraphTitle.Font = Enum.Font.GothamBold
        ParagraphTitle.Text = ParagraphConfig.Title
        ParagraphTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        ParagraphTitle.TextSize = 11
        ParagraphTitle.TextXAlignment = Enum.TextXAlignment.Left
        ParagraphTitle.TextYAlignment = Enum.TextYAlignment.Top

        ParagraphContent.Name = "ParagraphContent"
        ParagraphContent.Parent = Paragraph
        ParagraphContent.BackgroundTransparency = 1
        ParagraphContent.Position = ParagraphConfig.IconLabel ~= "" and UDim2.new(0, ParagraphConfig.SizeIcon + 14, 0, 22) or UDim2.new(0, 8, 0, 22)
        ParagraphContent.Size = UDim2.new(1, -(ParagraphConfig.IconLabel ~= "" and (ParagraphConfig.SizeIcon + 20) or 14), 1, -28)
        ParagraphContent.Font = Enum.Font.Gotham
        ParagraphContent.Text = ParagraphConfig.Content
        ParagraphContent.TextColor3 = Color3.fromRGB(160, 160, 160)
        ParagraphContent.TextSize = 9
        ParagraphContent.TextWrapped = true
        ParagraphContent.TextXAlignment = Enum.TextXAlignment.Left
        ParagraphContent.TextYAlignment = Enum.TextYAlignment.Top
        ParagraphContent.AutomaticSize = Enum.AutomaticSize.Y

        local function UpdateSize()
            Paragraph.Size = UDim2.new(1, 0, 0, ParagraphContent.AbsoluteSize.Y + 34)
        end

        ParagraphContent:GetPropertyChangedSignal("AbsoluteSize"):Connect(UpdateSize)
        UpdateSize()

        return {
            SetTitle = function(newTitle)
                ParagraphTitle.Text = newTitle
            end,
            SetContent = function(newContent)
                ParagraphContent.Text = newContent
            end
        }
    end

    -- ADD TAB FUNCTION
    function WindowSystem:AddTab(TabConfig)
        TabConfig = TabConfig or {}
        TabConfig.Title = TabConfig.Title or "Tab"
        TabConfig.Icon = TabConfig.Icon or ""

        local Tab = Instance.new("Frame")
        local TabCorner = Instance.new("UICorner")
        local TabIcon = Instance.new("ImageLabel")
        local TabLabel = Instance.new("TextLabel")
        local TabButton = Instance.new("TextButton")
        local TabIndicator = Instance.new("Frame")
        local IndicatorCorner = Instance.new("UICorner")
        local ScrollLayers = Instance.new("ScrollingFrame")
        local ScrollLayersLayout = Instance.new("UIListLayout")

        Tab.Name = "Tab"
        Tab.Parent = CrystalHub.TabScrollFrame
        Tab.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        Tab.BackgroundTransparency = 0.999
        Tab.BorderSizePixel = 0
        Tab.Size = UDim2.new(0, 60, 0, 40)

        TabCorner.CornerRadius = UDim.new(0, 6)
        TabCorner.Parent = Tab

        TabIcon.Name = "TabIcon"
        TabIcon.Parent = Tab
        TabIcon.BackgroundTransparency = 1
        TabIcon.Position = UDim2.new(0, 6, 0, 6)
        TabIcon.Size = UDim2.new(0, 16, 0, 16)
        TabIcon.Image = TabConfig.Icon
        TabIcon.ImageTransparency = 0.600
        TabIcon.ImageColor3 = Color3.fromRGB(230, 230, 230)

        TabLabel.Name = "TabLabel"
        TabLabel.Parent = Tab
        TabLabel.BackgroundTransparency = 1
        TabLabel.Position = UDim2.new(0, 26, 0, 5)
        TabLabel.Size = UDim2.new(1, -30, 0, 18)
        TabLabel.Font = Enum.Font.GothamBold
        TabLabel.Text = TabConfig.Title
        TabLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
        TabLabel.TextSize = 10
        TabLabel.TextTransparency = 0.600
        TabLabel.TextXAlignment = Enum.TextXAlignment.Left

        TabButton.Name = "TabButton"
        TabButton.Parent = Tab
        TabButton.BackgroundTransparency = 1
        TabButton.BorderSizePixel = 0
        TabButton.Size = UDim2.new(1, 0, 1, 0)
        TabButton.Text = ""
        TabButton.Font = Enum.Font.GothamBold

        TabIndicator.Name = "TabIndicator"
        TabIndicator.Parent = Tab
        TabIndicator.AnchorPoint = Vector2.new(0.5, 1)
        TabIndicator.BackgroundColor3 = Color3.fromRGB(200, 170, 255)
        TabIndicator.BorderSizePixel = 0
        TabIndicator.Position = UDim2.new(0.5, 0, 1, -2)
        TabIndicator.Size = UDim2.new(0, 0, 0, 2.5)

        IndicatorCorner.CornerRadius = UDim.new(0, 100)
        IndicatorCorner.Parent = TabIndicator

        ScrollLayers.Name = "ScrollLayers"
        ScrollLayers.Parent = CrystalHub.LayersFolder
        ScrollLayers.Active = true
        ScrollLayers.BackgroundTransparency = 0.999
        ScrollLayers.BorderSizePixel = 0
        ScrollLayers.Size = UDim2.new(1, 0, 1, 0)
        ScrollLayers.ScrollBarImageColor3 = Color3.fromRGB(200, 170, 255)
        ScrollLayers.CanvasSize = UDim2.new(0, 0, 0, 0)
        ScrollLayers.ScrollBarImageTransparency = 0.700
        ScrollLayers.ScrollBarThickness = 3
        ScrollLayers.LayoutOrder = TabCount

        Crystal.Stepped:Connect(function()
            ScrollLayers.CanvasSize = UDim2.new(0, 0, 0, ScrollLayersLayout.AbsoluteContentSize.Y + 15)
        end)

        ScrollLayersLayout.Parent = ScrollLayers
        ScrollLayersLayout.SortOrder = Enum.SortOrder.LayoutOrder
        ScrollLayersLayout.Padding = UDim.new(0, 5)

        -- Auto-calculate Tab width based on text
        local textWidth = game:GetService("TextService"):GetTextSize(TabConfig.Title, 10, Enum.Font.GothamBold, Vector2.new(200, 18)).X
        Tab.Size = UDim2.new(0, math.max(textWidth + 38, 60), 0, 40)

        if TabCount == 0 then
            LayersPageLayout:JumpToIndex(0)
            Crystal.TweenObject({TabIndicator, 0.4, "Size", UDim2.new(0.8, 0, 0, 2.5)})
            TabIcon.ImageTransparency = 0
            TabLabel.TextTransparency = 0
            Tab.BackgroundTransparency = 0.950
            CurrentTab = Tab
        end

        Crystal.Mouseto(Tab, function()
            if CurrentTab ~= Tab then
                Tab.BackgroundTransparency = 0.970
            end
        end, function()
            if CurrentTab ~= Tab then
                Tab.BackgroundTransparency = 0.999
            end
        end)

        TabButton.Activated:Connect(function()
            if CurrentTab ~= Tab then
                -- Reset all tabs
                for _, v in pairs(CrystalHub.TabScrollFrame:GetChildren()) do
                    if v:IsA("Frame") then
                        Crystal.TweenObject({v, 0.4, "BackgroundTransparency", 0.999})
                        if v:FindFirstChild("TabIcon") then
                            Crystal.TweenObject({v.TabIcon, 0.4, "ImageTransparency", 0.600})
                        end
                        if v:FindFirstChild("TabLabel") then
                            Crystal.TweenObject({v.TabLabel, 0.4, "TextTransparency", 0.600})
                        end
                        if v:FindFirstChild("TabIndicator") then
                            Crystal.TweenObject({v.TabIndicator, 0.4, "Size", UDim2.new(0, 0, 0, 2.5)})
                        end
                    end
                end

                -- Set new tab as active
                CurrentTab = Tab
                Crystal.TweenObject({Tab, 0.4, "BackgroundTransparency", 0.950})
                Crystal.TweenObject({TabIcon, 0.4, "ImageTransparency", 0})
                Crystal.TweenObject({TabLabel, 0.4, "TextTransparency", 0})
                Crystal.TweenObject({TabIndicator, 0.4, "Size", UDim2.new(0.8, 0, 0, 2.5)})
                LayersPageLayout:JumpTo(ScrollLayers)
            end
        end)

        TabCount = TabCount + 1
        
        local ElementSystem = {}
        
        -- Elements can be added here (Button, Toggle, etc.)
        
        return ElementSystem
    end

    return WindowSystem
end

return Crystal