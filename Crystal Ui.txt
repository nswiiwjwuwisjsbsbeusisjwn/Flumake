local player = game.Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")

if CoreGui:FindFirstChild('Crystal hub') then
    CoreGui:FindFirstChild('Crystal hub'):Destroy()
end

local Crystal = {
    TweenService = game:GetService("TweenService"),
    Player = game.Players.LocalPlayer,
    Workspace = workspace,
    CoreGui = game:GetService("CoreGui"),
    UserInputService = game:GetService("UserInputService"),
    Mouse = game.Players.LocalPlayer:GetMouse(),
    ViewportSize = workspace.CurrentCamera.ViewportSize,
    Stepped = game:GetService("RunService").Stepped,
    OldMouseIcon = game.Players.LocalPlayer:GetMouse().Icon,
    TextService = game:GetService("TextService"),
    RunService = game:GetService("RunService")
}

-- Utility Functions
Crystal.TweenObject = function(config)
    config.Object = config.Object or config[1]
    config.Time = config.Time or config[2]
    config.OldValue = config.OldValue or config[3]
    config.NewValue = config.NewValue or config[4]
    local Info = TweenInfo.new(config.Time, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
    local tween = Crystal.TweenService:Create(config.Object, Info, {[config.OldValue] = config.NewValue})
    tween:Play()
    return tween
end

Crystal.Click = function(Object, callback)
    Object.Activated:Connect(function()
        callback()
    end)
end

Crystal.Find = function(Object, Name)
    for _, v in next, Object:GetChildren() do
        if v.Name == Name then
            return v
        end
    end
end

Crystal.Mouseto = function(Object, CallbackEnter, CallbackLeave)
    Object.MouseEnter:Connect(function()
        CallbackEnter()
    end)
    Object.MouseLeave:Connect(function()
        CallbackLeave()
    end)
end

Crystal.MakeDraggable = function(object, top)
    local Dragging = nil
    local DragInput = nil
    local DragStart = nil
    local StartPosition = nil
    local function UpdatePos(input)
        local Delta = input.Position - DragStart
        local newPos = UDim2.new(
            StartPosition.X.Scale,
            StartPosition.X.Offset + Delta.X,
            StartPosition.Y.Scale,
            StartPosition.Y.Offset + Delta.Y
        )
        object.Position = newPos
    end
    top.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    top.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)
    Crystal.UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            UpdatePos(input)
        end
    end)
end

Crystal.CustomSize = function(object)
    local Dragging = false
    local DragInput = nil
    local DragStart = nil
    local StartSize = nil
    local maxSizeX = object.Size.X.Offset
    local maxSizeY = object.Size.Y.Offset
    object.Size = UDim2.new(0, maxSizeX, 0, maxSizeY)
    local changesizeobject = Instance.new("Frame")
    changesizeobject.AnchorPoint = Vector2.new(1, 1)
    changesizeobject.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    changesizeobject.BackgroundTransparency = 0.999
    changesizeobject.BorderColor3 = Color3.fromRGB(0, 0, 0)
    changesizeobject.BorderSizePixel = 0
    changesizeobject.Position = UDim2.new(1, 20, 1, 20)
    changesizeobject.Size = UDim2.new(0, 40, 0, 40)
    changesizeobject.Name = "changesizeobject"
    changesizeobject.Parent = object
    Crystal.Mouseto(changesizeobject, function()
        Crystal.Mouse.Icon = "rbxassetid://97880490001888"
    end, function()
        Crystal.Mouse.Icon = Crystal.OldMouseIcon
    end)
    local function UpdateSize(input)
        local Delta = input.Position - DragStart
        local newWidth = StartSize.X.Offset + Delta.X
        local newHeight = StartSize.Y.Offset + Delta.Y
        newWidth = math.max(newWidth, maxSizeX)
        newHeight = math.max(newHeight, maxSizeY)
        object.Size = UDim2.new(0, newWidth, 0, newHeight)
    end
    changesizeobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartSize = object.Size
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    changesizeobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)
    Crystal.UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            UpdateSize(input)
        end
    end)
end

Crystal.GetMidPos = function(mainFrame)
    return UDim2.new(0, (Crystal.ViewportSize.X/2 - mainFrame.Size.X.Offset/2), 0, (Crystal.ViewportSize.Y/2 - mainFrame.Size.Y.Offset/2))
end

Crystal.Colors = { 
    Primary = Color3.fromRGB(100, 200, 255), 
    Secondary = Color3.fromRGB(180, 100, 255), 
    Background = Color3.fromRGB(10, 10, 20), 
    BackgroundSecondary = Color3.fromRGB(15, 20, 35), 
    BackgroundTertiary = Color3.fromRGB(20, 25, 40), 
    Text = Color3.fromRGB(255, 255, 255), 
    TextSecondary = Color3.fromRGB(180, 180, 180), 
    Border = Color3.fromRGB(80, 60, 120), 
    Accent = Color3.fromRGB(200, 170, 255),
    Purple = Color3.fromRGB(138, 43, 226)  -- Custom purple for theme
}

Crystal.Window = function(self, WindowConfig)
    WindowConfig = WindowConfig or {}
    WindowConfig.Title = WindowConfig.Title or "Crystal Hub"
    WindowConfig.Description = WindowConfig.Description or ""
    WindowConfig.Size = WindowConfig.Size or UDim2.new(0, 600, 0, 400)
    WindowConfig.KeyCode = WindowConfig.KeyCode or Enum.KeyCode.RightControl

    local CrystalHub = {}
    CrystalHub.Window = Instance.new("ScreenGui")
    CrystalHub.MainFrame = Instance.new("Frame")
    CrystalHub.DropShadowHolder = Instance.new("Frame")
    CrystalHub.DropShadow = Instance.new("ImageLabel")
    CrystalHub.TopBar = Instance.new("Frame")
    CrystalHub.TopTitle = Instance.new("TextLabel")
    CrystalHub.TopDescription = Instance.new("TextLabel")
    CrystalHub.MinButton = Instance.new("TextButton")
    CrystalHub.MinImage = Instance.new("ImageLabel")
    CrystalHub.MaxButton = Instance.new("TextButton")
    CrystalHub.MaxImage = Instance.new("ImageLabel")
    CrystalHub.CloseButton = Instance.new("TextButton")
    CrystalHub.CloseImage = Instance.new("ImageLabel")
    CrystalHub.DecideFrame = Instance.new("Frame")
    CrystalHub.DecideCorner = Instance.new("UICorner")
    
    -- Player Info
    CrystalHub.PlayerInfo = Instance.new("Frame")
    CrystalHub.InfoCorner = Instance.new("UICorner")
    CrystalHub.PlayerName = Instance.new("TextLabel")
    CrystalHub.PlayerUsername = Instance.new("TextLabel")
    CrystalHub.PlayerDescription = Instance.new("TextLabel")
    CrystalHub.AvatarFrame = Instance.new("Frame")
    CrystalHub.AvatarImage = Instance.new("ImageLabel")
    CrystalHub.AvatarCorner = Instance.new("UICorner")
    CrystalHub.AvatarFrameCorner = Instance.new("UICorner")
    CrystalHub.AvatarStroke = Instance.new("UIStroke")
    CrystalHub.StatusIndicator = Instance.new("Frame")
    CrystalHub.StatusCorner = Instance.new("UICorner")
    CrystalHub.StatusStroke = Instance.new("UIStroke")
    
    -- Horizontal Tab Container
    CrystalHub.TabContainer = Instance.new("Frame")
    CrystalHub.TabScrollFrame = Instance.new("ScrollingFrame")
    CrystalHub.TabListLayout = Instance.new("UIListLayout")
    
    -- Paragraph Container (Below Tabs)
    CrystalHub.ParagraphContainer = Instance.new("Frame")
    CrystalHub.ParagraphScroll = Instance.new("ScrollingFrame")
    CrystalHub.ParagraphLayout = Instance.new("UIListLayout")
    
    -- Divider between tabs and paragraphs
    CrystalHub.Divider = Instance.new("Frame")
    
    -- Content/Layers Area
    CrystalHub.Layers = Instance.new("Frame")
    CrystalHub.LayersFolder = Instance.new("Folder")
    
    -- Status Bar at Bottom
    CrystalHub.StatusBar = Instance.new("Frame")
    CrystalHub.StatusCorner = Instance.new("UICorner")
    CrystalHub.StatusStroke = Instance.new("UIStroke")
    CrystalHub.StatusLabel = Instance.new("TextLabel")
    CrystalHub.FPSLabel = Instance.new("TextLabel")
    CrystalHub.StatusDivider = Instance.new("Frame")
    
    CrystalHub.MainCorner = Instance.new("UICorner")
    CrystalHub.MainStroke = Instance.new("UIStroke")
    CrystalHub.CloseCorner = Instance.new("UICorner")

    CrystalHub.Window.Name = "Crystal hub"
    CrystalHub.Window.Parent = Crystal.CoreGui
    CrystalHub.Window.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    CrystalHub.MainFrame.Name = "Window11"
    CrystalHub.MainFrame.Parent = CrystalHub.Window
    CrystalHub.MainFrame.BackgroundColor3 = Crystal.Colors.Background
    CrystalHub.MainFrame.BackgroundTransparency = 0
    CrystalHub.MainFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MainFrame.BorderSizePixel = 0
    CrystalHub.MainFrame.Size = WindowConfig.Size
    CrystalHub.MainFrame.Position = Crystal.GetMidPos(CrystalHub.MainFrame)
    CrystalHub.MainFrame.ClipsDescendants = true

    CrystalHub.MainCorner.CornerRadius = UDim.new(0, 12)
    CrystalHub.MainCorner.Parent = CrystalHub.MainFrame

    CrystalHub.MainStroke.Parent = CrystalHub.MainFrame
    CrystalHub.MainStroke.Color = Crystal.Colors.Accent
    CrystalHub.MainStroke.Thickness = 1.5
    CrystalHub.MainStroke.Transparency = 0.2

    -- Drop Shadow
    CrystalHub.DropShadowHolder.Name = "DropShadowHolder"
    CrystalHub.DropShadowHolder.Parent = CrystalHub.MainFrame
    CrystalHub.DropShadowHolder.BackgroundTransparency = 1
    CrystalHub.DropShadowHolder.BorderSizePixel = 0
    CrystalHub.DropShadowHolder.Size = UDim2.new(1, 0, 1, 0)
    CrystalHub.DropShadowHolder.ZIndex = -1

    CrystalHub.DropShadow.Name = "DropShadow"
    CrystalHub.DropShadow.Parent = CrystalHub.DropShadowHolder
    CrystalHub.DropShadow.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.DropShadow.BackgroundTransparency = 1
    CrystalHub.DropShadow.BorderSizePixel = 0
    CrystalHub.DropShadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.DropShadow.Size = UDim2.new(1, 50, 1, 50)
    CrystalHub.DropShadow.ZIndex = -1
    CrystalHub.DropShadow.Image = "rbxassetid://6015897843"
    CrystalHub.DropShadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.DropShadow.ImageTransparency = 0.4
    CrystalHub.DropShadow.ScaleType = Enum.ScaleType.Slice
    CrystalHub.DropShadow.SliceCenter = Rect.new(49, 49, 450, 450)

    -- Top Bar
    CrystalHub.TopBar.Name = "TopBar"
    CrystalHub.TopBar.Parent = CrystalHub.MainFrame
    CrystalHub.TopBar.BackgroundColor3 = Crystal.Colors.BackgroundSecondary
    CrystalHub.TopBar.BackgroundTransparency = 0.1
    CrystalHub.TopBar.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopBar.BorderSizePixel = 0
    CrystalHub.TopBar.Size = UDim2.new(1, 0, 0, 40)
    CrystalHub.TopBar.ZIndex = 10

    local TopBarStroke = Instance.new("UIStroke")
    TopBarStroke.Parent = CrystalHub.TopBar
    TopBarStroke.Color = Crystal.Colors.Border
    TopBarStroke.Thickness = 1

    CrystalHub.TopTitle.Name = "TopTitle"
    CrystalHub.TopTitle.Parent = CrystalHub.TopBar
    CrystalHub.TopTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopTitle.BackgroundTransparency = 1
    CrystalHub.TopTitle.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopTitle.BorderSizePixel = 0
    CrystalHub.TopTitle.Position = UDim2.new(0, 15, 0, 8)
    CrystalHub.TopTitle.Size = UDim2.new(0, 200, 0, 24)
    CrystalHub.TopTitle.Font = Enum.Font.GothamBold
    CrystalHub.TopTitle.Text = WindowConfig.Title
    CrystalHub.TopTitle.TextColor3 = Crystal.Colors.Text
    CrystalHub.TopTitle.TextSize = 16
    CrystalHub.TopTitle.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.TopDescription.Name = "TopDescription"
    CrystalHub.TopDescription.Parent = CrystalHub.TopBar
    CrystalHub.TopDescription.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.TopDescription.BackgroundTransparency = 1
    CrystalHub.TopDescription.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.TopDescription.BorderSizePixel = 0
    CrystalHub.TopDescription.Position = UDim2.new(0, 15, 0, 26)
    CrystalHub.TopDescription.Size = UDim2.new(0, 200, 0, 12)
    CrystalHub.TopDescription.Font = Enum.Font.Gotham
    CrystalHub.TopDescription.Text = WindowConfig.Description
    CrystalHub.TopDescription.TextColor3 = Crystal.Colors.Accent
    CrystalHub.TopDescription.TextSize = 10
    CrystalHub.TopDescription.TextXAlignment = Enum.TextXAlignment.Left

    -- Title Bar Buttons
    local buttonSize = UDim2.new(0, 32, 0, 32)
    local buttonPosOffset = 4

    CrystalHub.MinButton.Name = "MinButton"
    CrystalHub.MinButton.Parent = CrystalHub.TopBar
    CrystalHub.MinButton.AnchorPoint = Vector2.new(1, 0.5)
    CrystalHub.MinButton.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.MinButton.BackgroundTransparency = 0.8
    CrystalHub.MinButton.BorderSizePixel = 0
    CrystalHub.MinButton.Position = UDim2.new(1, -buttonPosOffset - (32 * 2.5), 0.5, 0)
    CrystalHub.MinButton.Size = buttonSize
    CrystalHub.MinButton.Font = Enum.Font.GothamBold
    CrystalHub.MinButton.Text = ""
    CrystalHub.MinButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MinButton.TextSize = 14
    CrystalHub.MinButton.AutoButtonColor = false

    local MinCorner = Instance.new("UICorner")
    MinCorner.CornerRadius = UDim.new(0, 6)
    MinCorner.Parent = CrystalHub.MinButton

    CrystalHub.MinImage.Name = "MinImage"
    CrystalHub.MinImage.Parent = CrystalHub.MinButton
    CrystalHub.MinImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.MinImage.BackgroundTransparency = 1
    CrystalHub.MinImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.MinImage.Size = UDim2.new(0.6, 0, 0.6, 0)
    CrystalHub.MinImage.Image = "rbxassetid://18556824827"  -- Minimize icon
    CrystalHub.MinImage.ImageColor3 = Crystal.Colors.TextSecondary
    CrystalHub.MinImage.ScaleType = Enum.ScaleType.Fit

    Crystal.Mouseto(CrystalHub.MinButton, function()
        Crystal.TweenObject({CrystalHub.MinButton, 0.2, "BackgroundTransparency", 0.6})
        Crystal.TweenObject({CrystalHub.MinImage, 0.2, "ImageColor3", Crystal.Colors.Text})
    end, function()
        Crystal.TweenObject({CrystalHub.MinButton, 0.2, "BackgroundTransparency", 0.8})
        Crystal.TweenObject({CrystalHub.MinImage, 0.2, "ImageColor3", Crystal.Colors.TextSecondary})
    end)

    Crystal.Click(CrystalHub.MinButton, function()
        CrystalHub.MainFrame.Visible = false
    end)

    CrystalHub.MaxButton.Name = "MaxButton"
    CrystalHub.MaxButton.Parent = CrystalHub.TopBar
    CrystalHub.MaxButton.AnchorPoint = Vector2.new(1, 0.5)
    CrystalHub.MaxButton.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.MaxButton.BackgroundTransparency = 0.8
    CrystalHub.MaxButton.BorderSizePixel = 0
    CrystalHub.MaxButton.Position = UDim2.new(1, -buttonPosOffset - 32, 0.5, 0)
    CrystalHub.MaxButton.Size = buttonSize
    CrystalHub.MaxButton.Font = Enum.Font.GothamBold
    CrystalHub.MaxButton.Text = ""
    CrystalHub.MaxButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.MaxButton.TextSize = 14
    CrystalHub.MaxButton.AutoButtonColor = false

    local MaxCorner = Instance.new("UICorner")
    MaxCorner.CornerRadius = UDim.new(0, 6)
    MaxCorner.Parent = CrystalHub.MaxButton

    CrystalHub.MaxImage.Name = "MaxImage"
    CrystalHub.MaxImage.Parent = CrystalHub.MaxButton
    CrystalHub.MaxImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.MaxImage.BackgroundTransparency = 1
    CrystalHub.MaxImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.MaxImage.Size = UDim2.new(0.6, 0, 0.6, 0)
    CrystalHub.MaxImage.Image = "rbxassetid://9886659406"  -- Maximize icon
    CrystalHub.MaxImage.ImageColor3 = Crystal.Colors.TextSecondary
    CrystalHub.MaxImage.ScaleType = Enum.ScaleType.Fit

    local OldPos, OldSize
    Crystal.Click(CrystalHub.MaxButton, function()
        if CrystalHub.MainFrame.Size.X.Scale < 1 then
            OldPos = CrystalHub.MainFrame.Position
            OldSize = CrystalHub.MainFrame.Size
            Crystal.TweenObject({CrystalHub.MainFrame, 0.3, "Size", UDim2.new(1, -20, 1, -20)})
            Crystal.TweenObject({CrystalHub.MainFrame, 0.3, "Position", UDim2.new(0, 10, 0, 10)})
        else
            Crystal.TweenObject({CrystalHub.MainFrame, 0.3, "Size", OldSize})
            Crystal.TweenObject({CrystalHub.MainFrame, 0.3, "Position", OldPos})
        end
    end)

    Crystal.Mouseto(CrystalHub.MaxButton, function()
        Crystal.TweenObject({CrystalHub.MaxButton, 0.2, "BackgroundTransparency", 0.6})
        Crystal.TweenObject({CrystalHub.MaxImage, 0.2, "ImageColor3", Crystal.Colors.Text})
    end, function()
        Crystal.TweenObject({CrystalHub.MaxButton, 0.2, "BackgroundTransparency", 0.8})
        Crystal.TweenObject({CrystalHub.MaxImage, 0.2, "ImageColor3", Crystal.Colors.TextSecondary})
    end)

    CrystalHub.CloseButton.Name = "CloseButton"
    CrystalHub.CloseButton.Parent = CrystalHub.TopBar
    CrystalHub.CloseButton.AnchorPoint = Vector2.new(1, 0.5)
    CrystalHub.CloseButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
    CrystalHub.CloseButton.BackgroundTransparency = 0.8
    CrystalHub.CloseButton.BorderSizePixel = 0
    CrystalHub.CloseButton.Position = UDim2.new(1, -buttonPosOffset, 0.5, 0)
    CrystalHub.CloseButton.Size = buttonSize
    CrystalHub.CloseButton.Font = Enum.Font.GothamBold
    CrystalHub.CloseButton.Text = ""
    CrystalHub.CloseButton.TextColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.CloseButton.TextSize = 14
    CrystalHub.CloseButton.AutoButtonColor = false

    CrystalHub.CloseCorner.CornerRadius = UDim.new(0, 6)
    CrystalHub.CloseCorner.Parent = CrystalHub.CloseButton

    CrystalHub.CloseImage.Name = "CloseImage"
    CrystalHub.CloseImage.Parent = CrystalHub.CloseButton
    CrystalHub.CloseImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.CloseImage.BackgroundTransparency = 1
    CrystalHub.CloseImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.CloseImage.Size = UDim2.new(0.6, 0, 0.6, 0)
    CrystalHub.CloseImage.Image = "rbxassetid://18556800637"  -- Close icon
    CrystalHub.CloseImage.ImageColor3 = Crystal.Colors.Text
    CrystalHub.CloseImage.ScaleType = Enum.ScaleType.Fit

    Crystal.Mouseto(CrystalHub.CloseButton, function()
        Crystal.TweenObject({CrystalHub.CloseButton, 0.2, "BackgroundTransparency", 0.6})
        Crystal.TweenObject({CrystalHub.CloseImage, 0.2, "ImageColor3", Color3.fromRGB(255, 255, 255)})
    end, function()
        Crystal.TweenObject({CrystalHub.CloseButton, 0.2, "BackgroundTransparency", 0.8})
        Crystal.TweenObject({CrystalHub.CloseImage, 0.2, "ImageColor3", Crystal.Colors.Text})
    end)

    Crystal.Click(CrystalHub.CloseButton, function()
        CrystalHub.Window:Destroy()
    end)

    CrystalHub.DecideFrame.Name = "DecideFrame"
    CrystalHub.DecideFrame.Parent = CrystalHub.TopBar
    CrystalHub.DecideFrame.AnchorPoint = Vector2.new(0.5, 1)
    CrystalHub.DecideFrame.BackgroundColor3 = Crystal.Colors.Accent
    CrystalHub.DecideFrame.BackgroundTransparency = 0.7
    CrystalHub.DecideFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.DecideFrame.BorderSizePixel = 0
    CrystalHub.DecideFrame.Position = UDim2.new(0.5, 0, 1, 0)
    CrystalHub.DecideFrame.Size = UDim2.new(1, -20, 0, 2)
    
    CrystalHub.DecideCorner.CornerRadius = UDim.new(0, 1)
    CrystalHub.DecideCorner.Parent = CrystalHub.DecideFrame

    -- Player Info (Top Left)
    CrystalHub.PlayerInfo.Name = "PlayerInfo"
    CrystalHub.PlayerInfo.Parent = CrystalHub.MainFrame
    CrystalHub.PlayerInfo.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.PlayerInfo.BackgroundTransparency = 0.5
    CrystalHub.PlayerInfo.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerInfo.BorderSizePixel = 0
    CrystalHub.PlayerInfo.Position = UDim2.new(0, 10, 0, 50)
    CrystalHub.PlayerInfo.Size = UDim2.new(0, 160, 0, 60)

    CrystalHub.InfoCorner.CornerRadius = UDim.new(0, 8)
    CrystalHub.InfoCorner.Parent = CrystalHub.PlayerInfo

    local InfoStroke = Instance.new("UIStroke")
    InfoStroke.Parent = CrystalHub.PlayerInfo
    InfoStroke.Color = Crystal.Colors.Border
    InfoStroke.Thickness = 1
    InfoStroke.Transparency = 0.5

    CrystalHub.AvatarFrame.Name = "AvatarFrame"
    CrystalHub.AvatarFrame.Parent = CrystalHub.PlayerInfo
    CrystalHub.AvatarFrame.AnchorPoint = Vector2.new(0, 0.5)
    CrystalHub.AvatarFrame.BackgroundColor3 = Crystal.Colors.BackgroundSecondary
    CrystalHub.AvatarFrame.BackgroundTransparency = 0.3
    CrystalHub.AvatarFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.AvatarFrame.BorderSizePixel = 0
    CrystalHub.AvatarFrame.Position = UDim2.new(0, 10, 0.5, 0)
    CrystalHub.AvatarFrame.Size = UDim2.new(0, 40, 0, 40)

    CrystalHub.AvatarFrameCorner.CornerRadius = UDim.new(0, 20)
    CrystalHub.AvatarFrameCorner.Parent = CrystalHub.AvatarFrame

    CrystalHub.AvatarStroke.Parent = CrystalHub.AvatarFrame
    CrystalHub.AvatarStroke.Color = Crystal.Colors.Accent
    CrystalHub.AvatarStroke.Transparency = 0.5
    CrystalHub.AvatarStroke.Thickness = 2

    CrystalHub.AvatarImage.Name = "AvatarImage"
    CrystalHub.AvatarImage.Parent = CrystalHub.AvatarFrame
    CrystalHub.AvatarImage.AnchorPoint = Vector2.new(0.5, 0.5)
    CrystalHub.AvatarImage.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.AvatarImage.BackgroundTransparency = 1
    CrystalHub.AvatarImage.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.AvatarImage.BorderSizePixel = 0
    CrystalHub.AvatarImage.Position = UDim2.new(0.5, 0, 0.5, 0)
    CrystalHub.AvatarImage.Size = UDim2.new(1, -4, 1, -4)
    CrystalHub.AvatarImage.Image = "https://www.roblox.com/headshot-thumbnail/image?userId="..Crystal.Player.UserId.."&width=420&height=420&format=png"
    CrystalHub.AvatarImage.ScaleType = Enum.ScaleType.Fit

    CrystalHub.AvatarCorner.CornerRadius = UDim.new(1, 0)
    CrystalHub.AvatarCorner.Parent = CrystalHub.AvatarImage

    CrystalHub.StatusIndicator.Name = "StatusIndicator"
    CrystalHub.StatusIndicator.Parent = CrystalHub.AvatarFrame
    CrystalHub.StatusIndicator.AnchorPoint = Vector2.new(1, 1)
    CrystalHub.StatusIndicator.BackgroundColor3 = Color3.fromRGB(67, 181, 129)
    CrystalHub.StatusIndicator.BorderSizePixel = 0
    CrystalHub.StatusIndicator.Position = UDim2.new(1, -2, 1, -2)
    CrystalHub.StatusIndicator.Size = UDim2.new(0, 12, 0, 12)
    CrystalHub.StatusIndicator.ZIndex = 5

    CrystalHub.StatusCorner.CornerRadius = UDim.new(0, 6)
    CrystalHub.StatusCorner.Parent = CrystalHub.StatusIndicator

    CrystalHub.StatusStroke.Parent = CrystalHub.StatusIndicator
    CrystalHub.StatusStroke.Color = Color3.fromRGB(20, 20, 20)
    CrystalHub.StatusStroke.Thickness = 1.5

    CrystalHub.PlayerName.Name = "PlayerName"
    CrystalHub.PlayerName.Parent = CrystalHub.PlayerInfo
    CrystalHub.PlayerName.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerName.BackgroundTransparency = 1
    CrystalHub.PlayerName.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerName.BorderSizePixel = 0
    CrystalHub.PlayerName.Position = UDim2.new(0, 60, 0, 8)
    CrystalHub.PlayerName.Size = UDim2.new(1, -70, 0, 16)
    CrystalHub.PlayerName.Font = Enum.Font.GothamBold
    CrystalHub.PlayerName.Text = Crystal.Player.DisplayName
    CrystalHub.PlayerName.TextColor3 = Crystal.Colors.Text
    CrystalHub.PlayerName.TextSize = 13
    CrystalHub.PlayerName.TextTruncate = Enum.TextTruncate.AtEnd
    CrystalHub.PlayerName.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.PlayerUsername.Name = "PlayerUsername"
    CrystalHub.PlayerUsername.Parent = CrystalHub.PlayerInfo
    CrystalHub.PlayerUsername.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerUsername.BackgroundTransparency = 1
    CrystalHub.PlayerUsername.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerUsername.BorderSizePixel = 0
    CrystalHub.PlayerUsername.Position = UDim2.new(0, 60, 0, 24)
    CrystalHub.PlayerUsername.Size = UDim2.new(1, -70, 0, 12)
    CrystalHub.PlayerUsername.Font = Enum.Font.Gotham
    CrystalHub.PlayerUsername.Text = "@" .. Crystal.Player.Name
    CrystalHub.PlayerUsername.TextColor3 = Crystal.Colors.TextSecondary
    CrystalHub.PlayerUsername.TextSize = 10
    CrystalHub.PlayerUsername.TextTruncate = Enum.TextTruncate.AtEnd
    CrystalHub.PlayerUsername.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.PlayerDescription.Name = "PlayerDescription"
    CrystalHub.PlayerDescription.Parent = CrystalHub.PlayerInfo
    CrystalHub.PlayerDescription.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CrystalHub.PlayerDescription.BackgroundTransparency = 1
    CrystalHub.PlayerDescription.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.PlayerDescription.BorderSizePixel = 0
    CrystalHub.PlayerDescription.Position = UDim2.new(0, 60, 0, 38)
    CrystalHub.PlayerDescription.Size = UDim2.new(1, -70, 0, 10)
    CrystalHub.PlayerDescription.Font = Enum.Font.Gotham
    CrystalHub.PlayerDescription.Text = "ID: " .. Crystal.Player.UserId
    CrystalHub.PlayerDescription.TextColor3 = Crystal.Colors.TextSecondary
    CrystalHub.PlayerDescription.TextSize = 9
    CrystalHub.PlayerDescription.TextTransparency = 0.3
    CrystalHub.PlayerDescription.TextXAlignment = Enum.TextXAlignment.Left

    -- Horizontal Tab Container (Below Player Info)
    CrystalHub.TabContainer.Name = "TabContainer"
    CrystalHub.TabContainer.Parent = CrystalHub.MainFrame
    CrystalHub.TabContainer.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.TabContainer.BackgroundTransparency = 0.4
    CrystalHub.TabContainer.BorderSizePixel = 0
    CrystalHub.TabContainer.Position = UDim2.new(0, 10, 0, 120)
    CrystalHub.TabContainer.Size = UDim2.new(0, 160, 0, 40)
    CrystalHub.TabContainer.ZIndex = 5

    local TabContainerCorner = Instance.new("UICorner")
    TabContainerCorner.CornerRadius = UDim.new(0, 8)
    TabContainerCorner.Parent = CrystalHub.TabContainer

    local TabContainerStroke = Instance.new("UIStroke")
    TabContainerStroke.Parent = CrystalHub.TabContainer
    TabContainerStroke.Color = Crystal.Colors.Border
    TabContainerStroke.Thickness = 1
    TabContainerStroke.Transparency = 0.5

    CrystalHub.TabScrollFrame.Name = "TabScrollFrame"
    CrystalHub.TabScrollFrame.Parent = CrystalHub.TabContainer
    CrystalHub.TabScrollFrame.Active = true
    CrystalHub.TabScrollFrame.BackgroundTransparency = 1
    CrystalHub.TabScrollFrame.BorderSizePixel = 0
    CrystalHub.TabScrollFrame.Position = UDim2.new(0, 5, 0, 5)
    CrystalHub.TabScrollFrame.Size = UDim2.new(1, -10, 1, -10)
    CrystalHub.TabScrollFrame.ScrollBarThickness = 0
    CrystalHub.TabScrollFrame.ScrollingDirection = Enum.ScrollingDirection.X
    CrystalHub.TabScrollFrame.ScrollBarImageColor3 = Crystal.Colors.Accent
    CrystalHub.TabScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)

    CrystalHub.TabListLayout.Parent = CrystalHub.TabScrollFrame
    CrystalHub.TabListLayout.FillDirection = Enum.FillDirection.Horizontal
    CrystalHub.TabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    CrystalHub.TabListLayout.Padding = UDim.new(0, 8)
    CrystalHub.TabListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    Crystal.Stepped:Connect(function()
        CrystalHub.TabScrollFrame.CanvasSize = UDim2.new(0, CrystalHub.TabListLayout.AbsoluteContentSize.X + 20, 0, 0)
    end)

    -- Divider
    CrystalHub.Divider.Name = "Divider"
    CrystalHub.Divider.Parent = CrystalHub.MainFrame
    CrystalHub.Divider.BackgroundColor3 = Crystal.Colors.Accent
    CrystalHub.Divider.BackgroundTransparency = 0.5
    CrystalHub.Divider.BorderSizePixel = 0
    CrystalHub.Divider.Position = UDim2.new(0, 10, 0, 164)
    CrystalHub.Divider.Size = UDim2.new(0, 160, 0, 1)

    -- Paragraph Container (Below Divider, Left Side)
    CrystalHub.ParagraphContainer.Name = "ParagraphContainer"
    CrystalHub.ParagraphContainer.Parent = CrystalHub.MainFrame
    CrystalHub.ParagraphContainer.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.ParagraphContainer.BackgroundTransparency = 0.4
    CrystalHub.ParagraphContainer.BorderSizePixel = 0
    CrystalHub.ParagraphContainer.Position = UDim2.new(0, 10, 0, 168)
    CrystalHub.ParagraphContainer.Size = UDim2.new(0, 160, 1, -228)  -- Adjusted for status bar
    CrystalHub.ParagraphContainer.ZIndex = 5

    local ParaContainerCorner = Instance.new("UICorner")
    ParaContainerCorner.CornerRadius = UDim.new(0, 8)
    ParaContainerCorner.Parent = CrystalHub.ParagraphContainer

    local ParaContainerStroke = Instance.new("UIStroke")
    ParaContainerStroke.Parent = CrystalHub.ParagraphContainer
    ParaContainerStroke.Color = Crystal.Colors.Border
    ParaContainerStroke.Thickness = 1
    ParaContainerStroke.Transparency = 0.5

    CrystalHub.ParagraphScroll.Name = "ParagraphScroll"
    CrystalHub.ParagraphScroll.Parent = CrystalHub.ParagraphContainer
    CrystalHub.ParagraphScroll.Active = true
    CrystalHub.ParagraphScroll.BackgroundTransparency = 1
    CrystalHub.ParagraphScroll.BorderSizePixel = 0
    CrystalHub.ParagraphScroll.Size = UDim2.new(1, -10, 1, -10)
    CrystalHub.ParagraphScroll.Position = UDim2.new(0, 5, 0, 5)
    CrystalHub.ParagraphScroll.ScrollBarImageColor3 = Crystal.Colors.Accent
    CrystalHub.ParagraphScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    CrystalHub.ParagraphScroll.ScrollBarImageTransparency = 0.7
    CrystalHub.ParagraphScroll.ScrollBarThickness = 4
    CrystalHub.ParagraphScroll.ScrollingDirection = Enum.ScrollingDirection.Y

    CrystalHub.ParagraphLayout.Parent = CrystalHub.ParagraphScroll
    CrystalHub.ParagraphLayout.SortOrder = Enum.SortOrder.LayoutOrder
    CrystalHub.ParagraphLayout.Padding = UDim.new(0, 10)
    CrystalHub.ParagraphLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    Crystal.Stepped:Connect(function()
        CrystalHub.ParagraphScroll.CanvasSize = UDim2.new(0, 0, 0, CrystalHub.ParagraphLayout.AbsoluteContentSize.Y + 20)
    end)

    -- Content Area (Right Side)
    CrystalHub.Layers.Name = "Layers"
    CrystalHub.Layers.Parent = CrystalHub.MainFrame
    CrystalHub.Layers.BackgroundColor3 = Crystal.Colors.BackgroundSecondary
    CrystalHub.Layers.BackgroundTransparency = 0.1
    CrystalHub.Layers.BorderColor3 = Color3.fromRGB(0, 0, 0)
    CrystalHub.Layers.BorderSizePixel = 0
    CrystalHub.Layers.Position = UDim2.new(0, 180, 0, 50)
    CrystalHub.Layers.Size = UDim2.new(1, -190, 1, -78)
    CrystalHub.Layers.ZIndex = 4
    CrystalHub.Layers.ClipsDescendants = true

    local LayersCorner = Instance.new("UICorner")
    LayersCorner.CornerRadius = UDim.new(0, 8)
    LayersCorner.Parent = CrystalHub.Layers

    local LayersStroke = Instance.new("UIStroke")
    LayersStroke.Parent = CrystalHub.Layers
    LayersStroke.Color = Crystal.Colors.Border
    LayersStroke.Thickness = 1
    LayersStroke.Transparency = 0.5

    CrystalHub.LayersFolder.Name = "LayersFolder"
    CrystalHub.LayersFolder.Parent = CrystalHub.Layers

    local LayersPageLayout = Instance.new("UIPageLayout")
    LayersPageLayout.Name = "LayersPageLayout"
    LayersPageLayout.Parent = CrystalHub.LayersFolder
    LayersPageLayout.SortOrder = Enum.SortOrder.LayoutOrder
    LayersPageLayout.EasingDirection = Enum.EasingDirection.InOut
    LayersPageLayout.EasingStyle = Enum.EasingStyle.Quad
    LayersPageLayout.GamepadInputEnabled = false
    LayersPageLayout.ScrollWheelInputEnabled = false
    LayersPageLayout.TouchInputEnabled = false
    LayersPageLayout.TweenTime = 0.35

    -- Status Bar (Bottom)
    CrystalHub.StatusBar.Name = "StatusBar"
    CrystalHub.StatusBar.Parent = CrystalHub.MainFrame
    CrystalHub.StatusBar.AnchorPoint = Vector2.new(0, 1)
    CrystalHub.StatusBar.BackgroundColor3 = Crystal.Colors.BackgroundTertiary
    CrystalHub.StatusBar.BackgroundTransparency = 0.3
    CrystalHub.StatusBar.BorderSizePixel = 0
    CrystalHub.StatusBar.Position = UDim2.new(0, 0, 1, 0)
    CrystalHub.StatusBar.Size = UDim2.new(1, 0, 0, 25)

    local StatusBarCorner = Instance.new("UICorner")
    StatusBarCorner.CornerRadius = UDim.new(0, 8)
    StatusBarCorner.Parent = CrystalHub.StatusBar

    CrystalHub.StatusStroke = Instance.new("UIStroke")
    CrystalHub.StatusStroke.Parent = CrystalHub.StatusBar
    CrystalHub.StatusStroke.Color = Crystal.Colors.Border
    CrystalHub.StatusStroke.Thickness = 1
    CrystalHub.StatusStroke.Transparency = 0.5

    CrystalHub.StatusLabel.Name = "StatusLabel"
    CrystalHub.StatusLabel.Parent = CrystalHub.StatusBar
    CrystalHub.StatusLabel.BackgroundTransparency = 1
    CrystalHub.StatusLabel.Position = UDim2.new(0, 10, 0.5, 0)
    CrystalHub.StatusLabel.AnchorPoint = Vector2.new(0, 0.5)
    CrystalHub.StatusLabel.Size = UDim2.new(0, 60, 1, 0)
    CrystalHub.StatusLabel.Font = Enum.Font.GothamBold
    CrystalHub.StatusLabel.Text = "Status"
    CrystalHub.StatusLabel.TextColor3 = Crystal.Colors.Text
    CrystalHub.StatusLabel.TextSize = 11
    CrystalHub.StatusLabel.TextXAlignment = Enum.TextXAlignment.Left

    CrystalHub.StatusDivider.Name = "StatusDivider"
    CrystalHub.StatusDivider.Parent = CrystalHub.StatusBar
    CrystalHub.StatusDivider.BackgroundColor3 = Crystal.Colors.Border
    CrystalHub.StatusDivider.BackgroundTransparency = 0.5
    CrystalHub.StatusDivider.BorderSizePixel = 0
    CrystalHub.StatusDivider.Position = UDim2.new(0, 75, 0, 5)
    CrystalHub.StatusDivider.AnchorPoint = Vector2.new(0, 0)
    CrystalHub.StatusDivider.Size = UDim2.new(0, 1, 1, -10)

    CrystalHub.FPSLabel.Name = "FPSLabel"
    CrystalHub.FPSLabel.Parent = CrystalHub.StatusBar
    CrystalHub.FPSLabel.BackgroundTransparency = 1
    CrystalHub.FPSLabel.Position = UDim2.new(0, 85, 0.5, 0)
    CrystalHub.FPSLabel.AnchorPoint = Vector2.new(0, 0.5)
    CrystalHub.FPSLabel.Size = UDim2.new(1, -95, 1, 0)
    CrystalHub.FPSLabel.Font = Enum.Font.Gotham
    CrystalHub.FPSLabel.Text = "FPS: Calculating..."
    CrystalHub.FPSLabel.TextColor3 = Crystal.Colors.TextSecondary
    CrystalHub.FPSLabel.TextSize = 11
    CrystalHub.FPSLabel.TextXAlignment = Enum.TextXAlignment.Left

    -- FPS Counter
    local lastFrame = tick()
    local frameCount = 0
    local fps = 0
    Crystal.RunService.RenderStepped:Connect(function()
        frameCount = frameCount + 1
        local currentTime = tick()
        if currentTime - lastFrame >= 1 then
            fps = math.floor(frameCount / (currentTime - lastFrame))
            frameCount = 0
            lastFrame = currentTime
            CrystalHub.FPSLabel.Text = "FPS: " .. fps
            -- Color code FPS
            if fps > 60 then
                CrystalHub.FPSLabel.TextColor3 = Color3.fromRGB(50, 200, 150)
            elseif fps > 30 then
                CrystalHub.FPSLabel.TextColor3 = Color3.fromRGB(255, 180, 100)
            else
                CrystalHub.FPSLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
            end
        end
    end)

    Crystal.MakeDraggable(CrystalHub.MainFrame, CrystalHub.TopBar)
    Crystal.CustomSize(CrystalHub.MainFrame)

    Crystal.UserInputService.InputBegan:Connect(function(input)
        if input.KeyCode == WindowConfig.KeyCode then
            CrystalHub.MainFrame.Visible = not CrystalHub.MainFrame.Visible
        end
    end)

    local WindowSystem = {}
    local TabCount = 0
    local CurrentTab = nil

    -- Add Paragraph Function (Left Side Content)
    function WindowSystem:AddParagraph(ParagraphConfig)
        ParagraphConfig = ParagraphConfig or {}
        ParagraphConfig.Title = ParagraphConfig.Title or "Paragraph"
        ParagraphConfig.Content = ParagraphConfig.Content or ""
        ParagraphConfig.Icon = ParagraphConfig.Icon or ""

        local Paragraph = Instance.new("Frame")
        local ParagraphCorner = Instance.new("UICorner")
        local ParagraphStroke = Instance.new("UIStroke")
        local ParagraphIcon = Instance.new("ImageLabel") if ParagraphConfig.Icon ~= "" then
        local ParagraphTitle = Instance.new("TextLabel")
        local ParagraphContent = Instance.new("TextLabel")

        Paragraph.Name = ParagraphConfig.Title
        Paragraph.Parent = CrystalHub.ParagraphScroll
        Paragraph.BackgroundColor3 = Crystal.Colors.BackgroundSecondary
        Paragraph.BackgroundTransparency = 0.2
        Paragraph.BorderSizePixel = 0
        Paragraph.Size = UDim2.new(1, -20, 0, 80)
        Paragraph.AutomaticSize = Enum.AutomaticSize.Y

        ParagraphCorner.CornerRadius = UDim.new(0, 6)
        ParagraphCorner.Parent = Paragraph

        ParagraphStroke.Parent = Paragraph
        ParagraphStroke.Color = Crystal.Colors.Border
        ParagraphStroke.Thickness = 1
        ParagraphStroke.Transparency = 0.7

        if ParagraphConfig.Icon ~= "" then
            ParagraphIcon.Name = "ParagraphIcon"
            ParagraphIcon.Parent = Paragraph
            ParagraphIcon.BackgroundTransparency = 1
            ParagraphIcon.Position = UDim2.new(0, 10, 0, 10)
            ParagraphIcon.Size = UDim2.new(0, 20, 0, 20)
            ParagraphIcon.Image = ParagraphConfig.Icon
            ParagraphIcon.ImageColor3 = Crystal.Colors.Accent
            ParagraphIcon.ImageTransparency = 0.2
            ParagraphIcon.ScaleType = Enum.ScaleType.Fit
        end

        ParagraphTitle.Name = "ParagraphTitle"
        ParagraphTitle.Parent = Paragraph
        ParagraphTitle.BackgroundTransparency = 1
        ParagraphTitle.Position = UDim2.new(0, ParagraphConfig.Icon ~= "" and 40 or 10, 0, 10)
        ParagraphTitle.Size = UDim2.new(1, - (ParagraphConfig.Icon ~= "" and 50 or 20), 0, 16)
        ParagraphTitle.Font = Enum.Font.GothamBold
        ParagraphTitle.Text = ParagraphConfig.Title
        ParagraphTitle.TextColor3 = Crystal.Colors.Text
        ParagraphTitle.TextSize = 12
        ParagraphTitle.TextXAlignment = Enum.TextXAlignment.Left
        ParagraphTitle.TextTruncate = Enum.TextTruncate.AtEnd

        ParagraphContent.Name = "ParagraphContent"
        ParagraphContent.Parent = Paragraph
        ParagraphContent.BackgroundTransparency = 1
        ParagraphContent.Position = UDim2.new(0, ParagraphConfig.Icon ~= "" and 40 or 10, 0, 30)
        ParagraphContent.Size = UDim2.new(1, - (ParagraphConfig.Icon ~= "" and 50 or 20), 1, -40)
        ParagraphContent.Font = Enum.Font.Gotham
        ParagraphContent.Text = ParagraphConfig.Content
        ParagraphContent.TextColor3 = Crystal.Colors.TextSecondary
        ParagraphContent.TextSize = 10
        ParagraphContent.TextWrapped = true
        ParagraphContent.TextXAlignment = Enum.TextXAlignment.Left
        ParagraphContent.AutomaticSize = Enum.AutomaticSize.Y

        local function UpdateSize()
            Paragraph.Size = UDim2.new(1, -20, 0, ParagraphContent.AbsoluteSize.Y + 50)
        end

        ParagraphContent:GetPropertyChangedSignal("AbsoluteSize"):Connect(UpdateSize)
        UpdateSize()

        Crystal.Mouseto(Paragraph, function()
            Crystal.TweenObject({Paragraph, 0.2, "BackgroundTransparency", 0.1})
            Crystal.TweenObject({ParagraphStroke, 0.2, "Transparency", 0.4})
        end, function()
            Crystal.TweenObject({Paragraph, 0.2, "BackgroundTransparency", 0.2})
            Crystal.TweenObject({ParagraphStroke, 0.2, "Transparency", 0.7})
        end)

        return {
            SetTitle = function(newTitle)
                ParagraphTitle.Text = newTitle
            end,
            SetContent = function(newContent)
                ParagraphContent.Text = newContent
                UpdateSize()
            end
        }
    end

    -- Add Tab Function (Horizontal Tabs)
    function WindowSystem:AddTab(TabConfig)
        TabConfig = TabConfig or {}
        TabConfig.Title = TabConfig.Title or "Tab"
        TabConfig.Icon = TabConfig.Icon or ""

        local Tab = Instance.new("Frame")
        local TabCorner = Instance.new("UICorner")
        local TabStroke = Instance.new("UIStroke")
        local TabIcon = Instance.new("ImageLabel")
        local TabLabel = Instance.new("TextLabel")
        local TabButton = Instance.new("TextButton")
        local TabIndicator = Instance.new("Frame")
        local IndicatorCorner = Instance.new("UICorner")
        local ScrollLayers = Instance.new("ScrollingFrame")
        local ScrollLayersLayout = Instance.new("UIListLayout")

        Tab.Name = TabConfig.Title
        Tab.Parent = CrystalHub.TabScrollFrame
        Tab.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        Tab.BackgroundTransparency = 1
        Tab.BorderSizePixel = 0
        Tab.Size = UDim2.new(0, 80, 1, 0)

        TabCorner.CornerRadius = UDim.new(0, 6)
        TabCorner.Parent = Tab

        TabStroke.Parent = Tab
        TabStroke.Color = Crystal.Colors.Border
        TabStroke.Thickness = 1
        TabStroke.Transparency = 0.8

        TabIcon.Name = "TabIcon"
        TabIcon.Parent = Tab
        TabIcon.BackgroundTransparency = 1
        TabIcon.Position = UDim2.new(0.5, 0, 0, 8)
        TabIcon.AnchorPoint = Vector2.new(0.5, 0)
        TabIcon.Size = UDim2.new(0, 20, 0, 20)
        TabIcon.Image = TabConfig.Icon
        TabIcon.ImageTransparency = 0.6
        TabIcon.ImageColor3 = Crystal.Colors.TextSecondary
        TabIcon.ScaleType = Enum.ScaleType.Fit

        TabLabel.Name = "TabLabel"
        TabLabel.Parent = Tab
        TabLabel.BackgroundTransparency = 1
        TabLabel.Position = UDim2.new(0.5, 0, 0, 32)
        TabLabel.AnchorPoint = Vector2.new(0.5, 0)
        TabLabel.Size = UDim2.new(1, -10, 0, 14)
        TabLabel.Font = Enum.Font.GothamSemibold
        TabLabel.Text = TabConfig.Title
        TabLabel.TextColor3 = Crystal.Colors.TextSecondary
        TabLabel.TextSize = 10
        TabLabel.TextTransparency = 0.3
        TabLabel.TextXAlignment = Enum.TextXAlignment.Center
        TabLabel.TextTruncate = Enum.TextTruncate.AtEnd

        TabButton.Name = "TabButton"
        TabButton.Parent = Tab
        TabButton.BackgroundTransparency = 1
        TabButton.BorderSizePixel = 0
        TabButton.Size = UDim2.new(1, 0, 1, 0)
        TabButton.Text = ""
        TabButton.Font = Enum.Font.GothamBold
        TabButton.ZIndex = 6

        TabIndicator.Name = "TabIndicator"
        TabIndicator.Parent = Tab
        TabIndicator.AnchorPoint = Vector2.new(0.5, 1)
        TabIndicator.BackgroundColor3 = Crystal.Colors.Accent
        TabIndicator.BorderSizePixel = 0
        TabIndicator.Position = UDim2.new(0.5, 0, 1, 0)
        TabIndicator.Size = UDim2.new(0, 0, 0, 3)
        TabIndicator.ZIndex = 5

        IndicatorCorner.CornerRadius = UDim.new(0, 3)
        IndicatorCorner.Parent = TabIndicator

        ScrollLayers.Name = "ScrollLayers"
        ScrollLayers.Parent = CrystalHub.LayersFolder
        ScrollLayers.Active = true
        ScrollLayers.BackgroundTransparency = 1
        ScrollLayers.BorderSizePixel = 0
        ScrollLayers.Size = UDim2.new(1, 0, 1, 0)
        ScrollLayers.ScrollBarImageColor3 = Crystal.Colors.Accent
        ScrollLayers.CanvasSize = UDim2.new(0, 0, 0, 0)
        ScrollLayers.ScrollBarImageTransparency = 0.7
        ScrollLayers.ScrollBarThickness = 4
        ScrollLayers.LayoutOrder = TabCount

        local ContentLayout = Instance.new("UIListLayout")
        ContentLayout.Parent = ScrollLayers
        ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
        ContentLayout.Padding = UDim.new(0, 8)
        ContentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Fill

        Crystal.Stepped:Connect(function()
            ScrollLayers.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 20)
        end)

        -- Auto-size tab based on text
        local textBounds = Crystal.TextService:GetTextSize(TabConfig.Title, 10, Enum.Font.GothamSemibold, Vector2.new(1000, 14))
        Tab.Size = UDim2.new(0, math.max(textBounds.X + 40, 80), 1, 0)

        if TabCount == 0 then
            CurrentTab = Tab
            Tab.BackgroundTransparency = 0.9
            TabIcon.ImageTransparency = 0
            TabLabel.TextTransparency = 0
            TabStroke.Transparency = 0.4
            TabIndicator.Size = UDim2.new(0.8, 0, 0, 3)
            LayersPageLayout:JumpToIndex(0)
        end

        Crystal.Mouseto(Tab, function()
            if CurrentTab ~= Tab then
                Tab.BackgroundTransparency = 0.85
                TabIcon.ImageTransparency = 0.3
                TabLabel.TextTransparency = 0.1
                TabStroke.Transparency = 0.5
            end
        end, function()
            if CurrentTab ~= Tab then
                Tab.BackgroundTransparency = 1
                TabIcon.ImageTransparency = 0.6
                TabLabel.TextTransparency = 0.3
                TabStroke.Transparency = 0.8
            end
        end)

        TabButton.Activated:Connect(function()
            if CurrentTab ~= Tab then
                -- Reset previous
                if CurrentTab then
                    CurrentTab.BackgroundTransparency = 1
                    CurrentTab.TabIcon.ImageTransparency = 0.6
                    CurrentTab.TabLabel.TextTransparency = 0.3
                    CurrentTab.TabStroke.Transparency = 0.8
                    CurrentTab.TabIndicator.Size = UDim2.new(0, 0, 0, 3)
                end

                -- Activate new
                CurrentTab = Tab
                Tab.BackgroundTransparency = 0.9
                TabIcon.ImageTransparency = 0
                TabLabel.TextTransparency = 0
                TabStroke.Transparency = 0.4
                TabIndicator.Size = UDim2.new(0.8, 0, 0, 3)
                LayersPageLayout:JumpTo(ScrollLayers)
            end
        end)

        TabCount = TabCount + 1
        
        local TabObject = {}

        -- Add Button to Tab Content
        function TabObject:AddButton(ButtonConfig)
            ButtonConfig = ButtonConfig or {}
            ButtonConfig.Title = ButtonConfig.Title or "Button"
            ButtonConfig.Description = ButtonConfig.Description or ""
            ButtonConfig.Callback = ButtonConfig.Callback or function() end

            local Button = Instance.new("Frame")
            local ButtonCorner = Instance.new("UICorner")
            local ButtonStroke = Instance.new("UIStroke")
            local ButtonTitle = Instance.new("TextLabel")
            local ButtonDescription = Instance.new("TextLabel")
            local ButtonClick = Instance.new("TextButton")
            local ButtonIcon = Instance.new("ImageLabel")

            Button.Name = ButtonConfig.Title
            Button.Parent = ScrollLayers
            Button.BackgroundColor3 = Crystal.Colors.BackgroundSecondary
            Button.BackgroundTransparency = 0.3
            Button.BorderSizePixel = 0
            Button.Size = UDim2.new(1, -20, 0, 50)

            ButtonCorner.CornerRadius = UDim.new(0, 8)
            ButtonCorner.Parent = Button

            ButtonStroke.Parent = Button
            ButtonStroke.Color = Crystal.Colors.Border
            ButtonStroke.Thickness = 1
            ButtonStroke.Transparency = 0.6

            ButtonIcon.Name = "ButtonIcon"
            ButtonIcon.Parent = Button
            ButtonIcon.BackgroundTransparency = 1
            ButtonIcon.Position = UDim2.new(0, 12, 0.5, 0)
            ButtonIcon.AnchorPoint = Vector2.new(0, 0.5)
            ButtonIcon.Size = UDim2.new(0, 20, 0, 20)
            ButtonIcon.Image = "rbxassetid://18558566660"
            ButtonIcon.ImageColor3 = Crystal.Colors.TextSecondary
            ButtonIcon.ScaleType = Enum.ScaleType.Fit

            ButtonTitle.Name = "ButtonTitle"
            ButtonTitle.Parent = Button
            ButtonTitle.BackgroundTransparency = 1
            ButtonTitle.Position = UDim2.new(0, 40, 0, 10)
            ButtonTitle.Size = UDim2.new(1, -60, 0, 16)
            ButtonTitle.Font = Enum.Font.GothamBold
            ButtonTitle.Text = ButtonConfig.Title
            ButtonTitle.TextColor3 = Crystal.Colors.Text
            ButtonTitle.TextSize = 12
            ButtonTitle.TextXAlignment = Enum.TextXAlignment.Left

            ButtonDescription.Name = "ButtonDescription"
            ButtonDescription.Parent = Button
            ButtonDescription.BackgroundTransparency = 1
            ButtonDescription.Position = UDim2.new(0, 40, 0, 28)
            ButtonDescription.Size = UDim2.new(1, -60, 0, 12)
            ButtonDescription.Font = Enum.Font.Gotham
            ButtonDescription.Text = ButtonConfig.Description
            ButtonDescription.TextColor3 = Crystal.Colors.TextSecondary
            ButtonDescription.TextSize = 10
            ButtonDescription.TextXAlignment = Enum.TextXAlignment.Left
            ButtonDescription.TextTransparency = 0.2

            ButtonClick.Name = "ButtonClick"
            ButtonClick.Parent = Button
            ButtonClick.BackgroundTransparency = 1
            ButtonClick.Size = UDim2.new(1, 0, 1, 0)
            ButtonClick.Text = ""
            ButtonClick.Font = Enum.Font.GothamBold
            ButtonClick.ZIndex = 5

            Crystal.Mouseto(Button, function()
                Crystal.TweenObject({Button, 0.2, "BackgroundTransparency", 0.2})
                Crystal.TweenObject({ButtonStroke, 0.2, "Transparency", 0.3})
                Crystal.TweenObject({ButtonIcon, 0.2, "ImageColor3", Crystal.Colors.Accent})
            end, function()
                Crystal.TweenObject({Button, 0.2, "BackgroundTransparency", 0.3})
                Crystal.TweenObject({ButtonStroke, 0.2, "Transparency", 0.6})
                Crystal.TweenObject({ButtonIcon, 0.2, "ImageColor3", Crystal.Colors.TextSecondary})
            end)

            Crystal.Click(ButtonClick, function()
                Crystal.TweenObject({Button, 0.1, "BackgroundTransparency", 0.1})
                task.wait(0.1)
                Crystal.TweenObject({Button, 0.1, "BackgroundTransparency", 0.3})
                pcall(ButtonConfig.Callback)
            end)

            return Button
        end

        return TabObject
    end

    return WindowSystem
end

return Crystal